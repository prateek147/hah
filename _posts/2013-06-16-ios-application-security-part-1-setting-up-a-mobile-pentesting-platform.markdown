---
layout: post
title: "iOS Application security Part 1 - Setting up a mobile pentesting platform"
date: 2013-06-16 02:53
comments: true
categories: security
---

In this article series, we will be learning about the tools and techniques required to perform penetration testing and Vulnerability assessment on iOS Applications.

## Jailbreaking your device

If you are serious about iOS security, then having a jailbroken device is a must. In this section, we will look at how we can jailbreak an iOS device. Jailbreaking a device has many advantages. You can install tools like nmap, metasploit and even run your own custom python code on the device. Imagine having the power to run a vulnerability scan on a website from the palm of your hand. To know more about jailbreaking and the advantages of doing it, i recommend you have a look at [this](http://www.ibtimes.com/why-jailbreak-your-iphone-5-reasons-you-should-download-evasi0n-jailbreak-ios-6-1080412) article.

<!-- more -->

Jailbreaking your device is as simple as downloading a jailbreaking software and clicking on jailbreak. I would recommend you use [evasi0n](http://evasi0n.com/) to jailbreak if your device if your device is running iOS 6.x and [redsn0w](http://www.redsn0w.us/) if your device is running iOS 5.x.

In this case, i am going to jailbreak my new Ipad (3rd generation) running iOS 6.0.1\. Once you download evasi0n and run it, you will see that it automatically detects the device and tells you if a jailbreak is available for it or not.

![1]({{site.baseurl}}/images/posts/ios1/1.png)

All you have to do is click on Jailbreak and let evasi0n do all the magic.

![2]({{site.baseurl}}/images/posts/ios1/2.png)

As you can see, the jailbreak process has started. After some time, evasi0n will reboot the device and run the exploit.

![3]({{site.baseurl}}/images/posts/ios1/3.png)

Once it is done running the exploit, it will install Cydia and its packages list on the device. Cydia is a GUI that allows you to download software packages and other apps on your jailbroken device that you would normally not find on the App store. Mostly all the jailbreak softwares install Cydia on your device by default. You can call Cydia the App Store for jailbroken devices.

![4]({{site.baseurl}}/images/posts/ios1/4.png)

Wait for some more time until you get this prompt

![5]({{site.baseurl}}/images/posts/ios1/5.png)

If you go to your device, you will see that a new app icon named _Jailbreak_ has come up. Tap on it to finish the jailbreak process.

![6]({{site.baseurl}}/images/posts/ios1/6.PNG)

You will see that your device will reboot. Please wait patiently and wait for the process to finish. Once the device has finished rebooting, you will see that a new app named _Cydia_ appears on your apps list. This is an indication that your device has been successfully jailbroken.

Congratulations, you have made the first leap in the field of iOS hacking.

## Setting up a mobile auditing platform

Now that you are done jailbreaking your device, the next step is to install some of the very important linux command line tools such as _wget, ps, apt-get_ and other applications used for auditing an iOS application. The first and foremost thing however is to install _OpenSSH_ on your device. This will allow you to login to your jailbroken device and perform various other tasks as we will see in this article later.

Go to Cydia, tap on the search tab on the bottom and search for OpenSSH.

![7]({{site.baseurl}}/images/posts/ios1/7.PNG)

Tap on OpenSSH and on the next view tap on install. Tap on Confirm on the next view to confirm this action.

![8]({{site.baseurl}}/images/posts/ios1/8.PNG)

This will insall OpenSSH on your device.

Before we use ssh to log in to the device, we should install some other command line tools also. Almost all the popular hacker tools can be installed by using the _BigBoss Recommended tools_ package which comes with a list of hacker tools. To install _BigBoss Recommended tools_ just search for it in Cydia and tap on install.

![9]({{site.baseurl}}/images/posts/ios1/9.PNG)

Some of the important command line tools that it installs are _APT 0.6 Transitional, Git, GNU Debugger, less, make, unzip, wget and SQLite 3.x_

One more thing that we can do is install _MobileTerminal_ from Cydia. It allow you to run terminal commands on your device from your device rather than logging in via ssh from a different system. Again, downloading _MobileTerminal_ on your device is as simple as searching for it in Cydia and tapping on Install

![10]({{site.baseurl}}/images/posts/ios1/10.PNG)

Once it is installed, you will see a new app icon with the name _Terminal_.

![11]({{site.baseurl}}/images/posts/ios1/11.PNG)

Tap on it, you will be given a terminal. Now try and run any Unix command on it. In this case, let me get a list of all the running processes by using the command _ps_

![12]({{site.baseurl}}/images/posts/ios1/12.PNG)

As you can see, it works !

Let's see if we can login to our jailbroken device using ssh. Make sure your laptop and the device are connected to the same network and then find out the IP address of the device. To find out the IP address of your device, just go to _Settings -> Wi-Fi_ and then click on the network your device is connected to.

![13]({{site.baseurl}}/images/posts/ios1/13.PNG)

As we can see, the IP address is _192.168.2.3_. Let's ssh to it as the user _root_. Just type in the follwing command as shown below.The default password for the user root is _alpine_. It is recommended that you should change your password as soon as you have Open SSH installed. This is because there has been many malwares which log in to your device and steal information by using the default username/password combination. To change the password, just type in _passwd_ and then type the new password twice. This will change the password for the user _root_.All of these steps have been perfomed in the image shown below.

![14]({{site.baseurl}}/images/posts/ios1/14.png)

_Note:Make sure the app Cydia is in the background while running any command that requires root privileges. This is because Cydia runs as root and hence it wouldn't be possible to get a lock on a process which is already being used by Cydia._

Once this is done, do an _apt-get update_ to get the latest packages lists.

![15]({{site.baseurl}}/images/posts/ios1/15.png)

It wouldn't be a bad idea to do an _apt-get upgrade_ also. This will fetch the new versions of packages that are already existing on the machine and don't have the latest version using the information contained from doing an _apt-get update_.

![16]({{site.baseurl}}/images/posts/ios1/16.png)

The next thing to do is to install class-dump-z which we will be using to dump class information from an iOS application. To get the application, go to its [official page](https://code.google.com/p/networkpx/wiki/class_dump_z) and copy the link for the latest version. At the time of writing of this article, the latest version is 0.2a.

![17]({{site.baseurl}}/images/posts/ios1/17.png)

Now, ssh into your device and fetch the file from that link using the command _wget_.

![18]({{site.baseurl}}/images/posts/ios1/18.png)

Another option would have been to download file on your system and then upload it to your device using _sftp_. Once the download has finished, use the tar program to extract the archive.

![19]({{site.baseurl}}/images/posts/ios1/19.png)

Once this is done, go inside the folder _iphone_armv6_ and copy the _class-dump-z_ executable into _/usr/bin_ directory. This will make sure you can run _class-dump-z_ from anywhere on the device. Once you have copied the executable, just type _class-dump-z_. If you get the output as shown in the figure below, this means that _class-dump-z_ has been successfully installed.

![20x]({{site.baseurl}}/images/posts/ios1/20x.png)

## Further Reading

There are not a lot of resources as far as iOS Security is concerned but here are some of the very good ones.

*   [SecurityTube](http://www.securitytube.net/) has a very detailed course on iOS security.
*   [Security Learn](http://www.securitylearn.net/) has some very good articles on penetration testing of iOS Applications.
*   [Hacking and Securing iOS applications](http://www.amazon.com/Hacking-Securing-iOS-Applications-Hijacking/dp/1449318746) is probably the best book i have read that deals with attacking iOS applications
*   [Lookout's](https://blog.lookout.com/) blog is also another valuable resource in learning about the latest techniques and exploits in the mobile world.

## Conclusion

In this article, we learned how to setup a mobile auditing environment on a jailbroken device. In the next article we will look at how we can analyze applications for class information using class-dump-z.

This article was originally published on the [resources](http://resources.infosecinstitute.com/) page at [Infosec Institute](http://infosecinstitute.com/). For more information, please visit my author [page](http://resources.infosecinstitute.com/author/prateek/).